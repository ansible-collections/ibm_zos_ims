---
- hosts: all
  collections:
    - ibm.ibm_zos_core
  gather_facts: no
  environment: "{{ environment_vars }}"

  vars:
    - volser: OMAR1
  vars_files:
    - host_vars/cicd_datasets.yml
    - host_vars/zos_host.yml

  # copies source datasets from volume sdv000 to usrv01
  tasks:
  - name: loop and copy datasets
    zos_copy:
      src: "{{ item.dataset.source }}"
      remote_src: true
      dest: "{{ item.dataset.target }}"
      volume: "{{ volser }}"
    loop: "{{ cicd_datasets }}"